(()=>{var e={577:function(e,t){var n,r;r=this,n=function(){return function(e){var t,n,r,o=o||void 0,i=(e=e||window).Postmonger,a=e.addEventListener||e.attachEvent?e:window;return(t=void 0!==o?o:{}).noConflict=function(){return e.Postmonger=i,this},t.version="0.0.14",n=t.Connection=function(e){var t=(e="object"==typeof e?e:{}).connect||a.parent,n=e.from||"*",r=e.to||"*",o=this;return"string"==typeof t&&(t=document.getElementById(t)),t&&!t.postMessage&&t.jquery&&(t=t.get(0)),t&&!t.postMessage&&(t.contentWindow||t.contentDocument)&&(t=t.contentWindow||t.contentDocument),t&&t.postMessage?(o.connect=t,o.to=r,o.from=n,o):(a.console&&a.console.warn&&a.console.warn(" Warning: Postmonger could not establish connection with ",e.connect),!1)},r=t.Events=function(){var e=/\s+/,t=this;return t._callbacks={},t._has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t._keys=function(e){if(Object.keys)return Object.keys(e);if("object"!=typeof e)throw new TypeError("Invalid object");var n=[];for(var r in e)t._has(e,r)&&(n[n.length]=r);return n},t.on=function(n,r,o){var i,a,s,c,l;if(!r)return t;for(n=n.split(e),t._callbacks=t._callbacks||{},i=t._callbacks;a=n.shift();)c={},(s=(l=i[a])?l.tail:{}).next=c,s.context=o,s.callback=r,i[a]={tail:c,next:l?l.next:s};return t},t.off=function(n,r,o){var i,a,s,c,l,u=t._callbacks;if(u){if(!(n||r||o))return delete t._callbacks,t;for(n=n?n.split(e):t._keys(u);i=n.shift();)if(a=u[i],delete u[i],a&&(r||o))for(s=a.tail;(a=a.next)!==s;)c=a.callback,l=a.context,(r&&c)===r&&(o&&l)===o||t.on(i,c,l);return t}},t.trigger=function(n){var r,o,i,a,s,c,l;if(!(i=t._callbacks))return t;for(c=i.all,n=n.split(e),l=Array.prototype.slice.call(arguments,1);r=n.shift();){if(o=i[r])for(a=o.tail;(o=o.next)!==a;)o.callback.apply(o.context||t,l);if(o=c)for(a=o.tail,s=[r].concat(l);(o=o.next)!==a;)o.callback.apply(o.context||t,s)}return t},t},t.Session=function(){var t,o,i,s,c,l,u=arguments.length>0?Array.prototype.slice.call(arguments,0):[{}],d=[],m=new r,p=new r,f=this;for(f.on=m.on,f.off=m.off,f.trigger=p.trigger,f.end=function(){return m.off(),p.off(),a.removeEventListener?a.removeEventListener("message",l,!1):a.detachEvent&&a.detachEvent("onmessage",l),f},o=0,s=u.length;o<s;o++)if(t=new n(u[o])){for(i=0,c=d.length;i<c;i++)if(d[i].connect===t.connect&&d[i].from===t.from&&d[i].to===t.to){t=null;break}t&&d.push(t)}if(l=function(t){var n,r,o,i=null,a=[];for(r=0,o=d.length;r<o;r++)if(d[r].connect===t.source){i=d[r];break}if(!i)return!1;if("*"!==i.from&&i.from!==t.origin)return!1;try{if(!(n=JSON.parse(t.data)).e)return!1}catch(e){return!1}for(r in a.push(n.e),delete n.e,n)a.push(n[r]);m.trigger.apply(e,a)},a.addEventListener)a.addEventListener("message",l,!1);else{if(!a.attachEvent)return a.console&&a.console.warn&&a.console.warn("WARNING: Postmonger could not listen for messages on window %o",a),!1;a.attachEvent("onmessage",l)}return p.on("all",function(){var e,t,n=Array.prototype.slice.call(arguments,0),r={};for(r.e=n[0],e=1,t=n.length;e<t;e++)r["a"+e]=n[e];for(e=0,t=d.length;e<t;e++)d[e].connect.postMessage(JSON.stringify(r),d[e].to)}),f},t}(r)}.apply(t,[]),void 0===n||(e.exports=n)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(577);const t=new(n.n(e)().Session);let r=null,o=!1;const i="Hey {{Contact.Attribute.DE.FirstName}}, surprise! Enjoy 60% off on your next purchase with code WELCOME60.",a="{{Contact.Attribute.DE.Mobile}}",s="Sending immediately";let c={campaignName:"Adidas India – Welcome Offer",senderName:"Adidas India",messageTemplate:"promo",messageBody:i,mediaUrl:"https://images.unsplash.com/photo-1549880338-65ddcdfd017b",buttonLabel:"Shop Now",sendType:"immediate",sendSchedule:"",recipientTo:a};const l=e=>document.getElementById(e),u=["campaignName","messageBody","recipientTo"],d=["campaignName","senderName","messageTemplate","messageBody","mediaUrl","buttonLabel","sendType","sendSchedule","recipientTo"],m="Seasonal promotion",p=i,f=s;let g=[],v=!1;function y(e){l("done").disabled=!e}function h(){const e=(e="")=>e?.trim();return{campaignName:e(l("campaignName")?.value),senderName:e(l("senderName")?.value)||"",messageTemplate:l("messageTemplate")?.value||"promo",messageBody:l("messageBody")?.value||"",mediaUrl:e(l("mediaUrl")?.value)||"",buttonLabel:e(l("buttonLabel")?.value)||"",sendType:l("sendType")?.value||"immediate",sendSchedule:e(l("sendSchedule")?.value)||"",recipientTo:e(l("recipientTo")?.value)||""}}function b(e=h()){return!(!u.every(t=>{const n=e[t];return"string"==typeof n?n.trim().length>0:Boolean(n)})||"schedule"===e.sendType&&!e.sendSchedule)}const T=/({{\s*[^{}]+\s*}})/g;function w(e,{multiline:t=!1}={}){const n=function(e=""){return String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}(e);return(t?n.replace(/\r?\n/g,"<br />"):n).replace(T,'<span class="preview-token">$1</span>')}function S(e,t,n,r={}){const o=l(e);if(!o)return;const i=function(e){return"string"==typeof e?e.length>0:Boolean(e)}(t)?t:n;o.innerHTML=w(i||"",r)}function L(){const e=h();c={...e},function(e=h()){const t="schedule"===e.sendType,n=l("scheduleFields");n&&n.classList.toggle("visible",t)}(e),function(e=h()){const t=l("messageCounter");if(!t)return;const n=e.messageBody.length;t.textContent=`${n} / 1024 characters`}(e),function(e=c){S("previewTemplateLabel",function(e){if(!e)return m;const{options:t,selectedIndex:n}=e;if("number"==typeof n&&n>=0){const e=t[n];if(e?.text)return e.text}const r=Array.from(t||[]).find(t=>t.value===e.value);return r?.text||m}(l("messageTemplate")),m),S("previewCampaign",e.campaignName,"Adidas India – Welcome Offer"),S("previewSender",e.senderName,"Adidas India"),S("previewMessage",e.messageBody,p,{multiline:!0}),function(e){const t=l("previewSendTiming");if(!t)return;const n=function(e){if("schedule"===e.sendType){if(!e.sendSchedule)return"Scheduled send (date required)";const t=e.sendSchedule;if(t.includes("{{"))return`Scheduled: ${t}`;const n=new Date(t);if(!Number.isNaN(n.getTime()))try{return`Scheduled: ${n.toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}`}catch(e){}return`Scheduled: ${t}`}return s}(e);t.textContent=n||f}(e),function(e){const t=l("previewMedia"),n=l("previewMediaImage");t&&n&&(e?(t.classList.add("visible"),n.src=e):(t.classList.remove("visible"),n.removeAttribute("src")))}(e.mediaUrl),function(e){const t=l("previewButton"),n=l("previewButtonText");t&&n&&(e?(t.hidden=!1,n.innerHTML=w(e)):(t.hidden=!0,n.textContent=""))}(e.buttonLabel)}(e),y(b(e)),o||t.trigger("setActivityDirtyState",!0)}function E(e,t){const n=l(e);n&&("SELECT"===n.tagName?n.value=t||n.options[0]?.value:n.value=t||"","recipientTo"===e&&(v=Boolean(t)))}function N(e){r=e||{};const t=(r?.arguments?.execute?.inArguments||[]).reduce((e,t)=>Object.assign(e,t),{});o=!0,E("campaignName",t.campaignName),E("senderName",t.senderName),E("messageTemplate",t.messageTemplate),E("messageBody",t.messageBody),E("mediaUrl",t.mediaUrl),E("buttonLabel",t.buttonLabel),E("sendType",t.sendType||"immediate"),E("sendSchedule",t.sendSchedule),E("recipientTo",t.recipientTo||t.mobile||t.to),L(),y(!1),o=!1}function x(e){const t=[["campaignName",e.campaignName],["senderName",e.senderName],["messageTemplate",e.messageTemplate],["messageBody",e.messageBody],["mediaUrl",e.mediaUrl],["buttonLabel",e.buttonLabel],["sendType",e.sendType],["recipientTo",e.recipientTo]];return"schedule"===e.sendType&&e.sendSchedule&&t.push(["sendSchedule",e.sendSchedule]),t.filter(([,e])=>e).map(([e,t])=>({[e]:t}))}function k(e){g=function(e=[]){return(e||[]).map(e=>({key:e?.key,name:e?.name||e?.key?.split(".")?.slice(-1)?.[0],type:e?.type||""})).filter(e=>Boolean(e.key))}(e?.schema),function(){const e=l("recipientOptions");e&&(e.innerHTML="",g.forEach(t=>{const n=document.createElement("option");n.value=A(t.key),n.textContent=t.name?`${t.name} · ${n.value}`:n.value,e.appendChild(n)}))}(),function(){if(v)return;const e=function(){if(!g?.length)return a;const e=g.find(e=>function(e={}){const t=(e.type||"").toLowerCase();if(t.includes("phone")||t.includes("tel"))return!0;const n=`${e.key||""} ${e.name||""}`.toLowerCase();return n.includes("phone")||n.includes("mobile")||n.includes("whatsapp")}(e))||g[0];return e?A(e.key):a}();if(!e)return;const t=l("recipientTo")?.value;t?v=!0:(o=!0,E("recipientTo",e),L(),o=!1)}()}function A(e){return e?e.startsWith("{{")?e:`{{${e}}}`:""}function C(){const e={...c};if(!b(e))return void y(!1);const n={...r,arguments:{...r?.arguments,execute:{...r?.arguments?.execute,inArguments:x(e),outArguments:[]}},configurationArguments:{...r?.configurationArguments},metaData:{...r?.metaData,isConfigured:!0}},o=document.createElement("div");o.className="status-message success",o.innerHTML='\n    <div class="icon">✓</div>\n    <div class="message">Configuration saved successfully!</div>\n  ',document.body.appendChild(o),setTimeout(()=>{o.remove()},3e3),t.trigger("updateActivity",n),t.trigger("setActivityDirtyState",!1),t.trigger("requestInspectorClose")}document.addEventListener("DOMContentLoaded",function(){d.forEach(e=>{const t=l(e);if(!t)return;const n="SELECT"===t.tagName||"datetime-local"===t.type?"change":"input";t.addEventListener(n,L)}),l("cancel")?.addEventListener("click",()=>{t.trigger("setActivityDirtyState",!1),t.trigger("requestInspectorClose")}),l("done")?.addEventListener("click",C),t.on("initActivity",N),t.on("requestedSchema",k),t.trigger("ready"),t.trigger("requestSchema"),t.trigger("requestInteraction")})})()})();