(()=>{var e={577:function(e,t){var n,o;o=this,n=function(){return function(e){var t,n,o,r=r||void 0,i=(e=e||window).Postmonger,a=e.addEventListener||e.attachEvent?e:window;return(t=void 0!==r?r:{}).noConflict=function(){return e.Postmonger=i,this},t.version="0.0.14",n=t.Connection=function(e){var t=(e="object"==typeof e?e:{}).connect||a.parent,n=e.from||"*",o=e.to||"*",r=this;return"string"==typeof t&&(t=document.getElementById(t)),t&&!t.postMessage&&t.jquery&&(t=t.get(0)),t&&!t.postMessage&&(t.contentWindow||t.contentDocument)&&(t=t.contentWindow||t.contentDocument),t&&t.postMessage?(r.connect=t,r.to=o,r.from=n,r):(a.console&&a.console.warn&&a.console.warn(" Warning: Postmonger could not establish connection with ",e.connect),!1)},o=t.Events=function(){var e=/\s+/,t=this;return t._callbacks={},t._has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t._keys=function(e){if(Object.keys)return Object.keys(e);if("object"!=typeof e)throw new TypeError("Invalid object");var n=[];for(var o in e)t._has(e,o)&&(n[n.length]=o);return n},t.on=function(n,o,r){var i,a,s,c,u;if(!o)return t;for(n=n.split(e),t._callbacks=t._callbacks||{},i=t._callbacks;a=n.shift();)c={},(s=(u=i[a])?u.tail:{}).next=c,s.context=r,s.callback=o,i[a]={tail:c,next:u?u.next:s};return t},t.off=function(n,o,r){var i,a,s,c,u,l=t._callbacks;if(l){if(!(n||o||r))return delete t._callbacks,t;for(n=n?n.split(e):t._keys(l);i=n.shift();)if(a=l[i],delete l[i],a&&(o||r))for(s=a.tail;(a=a.next)!==s;)c=a.callback,u=a.context,(o&&c)===o&&(r&&u)===r||t.on(i,c,u);return t}},t.trigger=function(n){var o,r,i,a,s,c,u;if(!(i=t._callbacks))return t;for(c=i.all,n=n.split(e),u=Array.prototype.slice.call(arguments,1);o=n.shift();){if(r=i[o])for(a=r.tail;(r=r.next)!==a;)r.callback.apply(r.context||t,u);if(r=c)for(a=r.tail,s=[o].concat(u);(r=r.next)!==a;)r.callback.apply(r.context||t,s)}return t},t},t.Session=function(){var t,r,i,s,c,u,l=arguments.length>0?Array.prototype.slice.call(arguments,0):[{}],d=[],m=new o,p=new o,f=this;for(f.on=m.on,f.off=m.off,f.trigger=p.trigger,f.end=function(){return m.off(),p.off(),a.removeEventListener?a.removeEventListener("message",u,!1):a.detachEvent&&a.detachEvent("onmessage",u),f},r=0,s=l.length;r<s;r++)if(t=new n(l[r])){for(i=0,c=d.length;i<c;i++)if(d[i].connect===t.connect&&d[i].from===t.from&&d[i].to===t.to){t=null;break}t&&d.push(t)}if(u=function(t){var n,o,r,i=null,a=[];for(o=0,r=d.length;o<r;o++)if(d[o].connect===t.source){i=d[o];break}if(!i)return!1;if("*"!==i.from&&i.from!==t.origin)return!1;try{if(!(n=JSON.parse(t.data)).e)return!1}catch(e){return!1}for(o in a.push(n.e),delete n.e,n)a.push(n[o]);m.trigger.apply(e,a)},a.addEventListener)a.addEventListener("message",u,!1);else{if(!a.attachEvent)return a.console&&a.console.warn&&a.console.warn("WARNING: Postmonger could not listen for messages on window %o",a),!1;a.attachEvent("onmessage",u)}return p.on("all",function(){var e,t,n=Array.prototype.slice.call(arguments,0),o={};for(o.e=n[0],e=1,t=n.length;e<t;e++)o["a"+e]=n[e];for(e=0,t=d.length;e<t;e++)d[e].connect.postMessage(JSON.stringify(o),d[e].to)}),f},t}(o)}.apply(t,[]),void 0===n||(e.exports=n)}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(577);const t=new(n.n(e)().Session);let o=null,r=!1;const i="Hey {{Contact.Attribute.DE.FirstName}}, surprise! Enjoy 60% off on your next purchase with code WELCOME60.",a="{{Contact.Attribute.DE.Mobile}}",s="Sending immediately";let c={campaignName:"Adidas India – Welcome Offer",senderName:"Adidas India",messageTemplate:"promo",messageBody:i,mediaUrl:"https://images.unsplash.com/photo-1549880338-65ddcdfd017b",buttonLabel:"Shop Now",sendType:"immediate",sendSchedule:"",recipientTo:a};const u=e=>document.getElementById(e),l=["campaignName","messageBody","recipientTo"],d=["campaignName","senderName","messageTemplate","messageBody","mediaUrl","buttonLabel","sendType","sendSchedule","recipientTo"],m="Seasonal promotion",p=i,f=s;let g=[],v=!1,y={},h={},b="message";function T(e){u("done").disabled=!e}function w(){const e=(e="")=>e?.trim();return{campaignName:e(u("campaignName")?.value),senderName:e(u("senderName")?.value)||"",messageTemplate:u("messageTemplate")?.value||"promo",messageBody:u("messageBody")?.value||"",mediaUrl:e(u("mediaUrl")?.value)||"",buttonLabel:e(u("buttonLabel")?.value)||"",sendType:u("sendType")?.value||"immediate",sendSchedule:e(u("sendSchedule")?.value)||"",recipientTo:e(u("recipientTo")?.value)||""}}function S(e=w()){return!(!l.every(t=>{const n=e[t];return"string"==typeof n?n.trim().length>0:Boolean(n)})||"schedule"===e.sendType&&!e.sendSchedule)}const k=/({{\s*[^{}]+\s*}})/g;function E(e,{multiline:t=!1}={}){const n=function(e=""){return String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}(e);return(t?n.replace(/\r?\n/g,"<br />"):n).replace(k,'<span class="preview-token">$1</span>')}function L(e,t,n,o={}){const r=u(e);if(!r)return;const i=function(e){return"string"==typeof e?e.length>0:Boolean(e)}(t)?t:n;r.innerHTML=E(i||"",o)}function N(){const e=w();c={...e},function(e=w()){const t="schedule"===e.sendType,n=u("scheduleFields");n&&n.classList.toggle("visible",t)}(e),function(e=w()){const t=u("messageCounter");if(!t)return;const n=e.messageBody.length;t.textContent=`${n} / 1024 characters`}(e),function(e=c){L("previewTemplateLabel",function(e){if(!e)return m;const{options:t,selectedIndex:n}=e;if("number"==typeof n&&n>=0){const e=t[n];if(e?.text)return e.text}const o=Array.from(t||[]).find(t=>t.value===e.value);return o?.text||m}(u("messageTemplate")),m),L("previewCampaign",e.campaignName,"Adidas India – Welcome Offer"),L("previewSender",e.senderName,"Adidas India"),L("previewMessage",e.messageBody,p,{multiline:!0}),function(e){const t=u("previewSendTiming");if(!t)return;const n=function(e){if("schedule"===e.sendType){if(!e.sendSchedule)return"Scheduled send (date required)";const t=e.sendSchedule;if(t.includes("{{"))return`Scheduled: ${t}`;const n=new Date(t);if(!Number.isNaN(n.getTime()))try{return`Scheduled: ${n.toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}`}catch(e){}return`Scheduled: ${t}`}return s}(e);t.textContent=n||f}(e),function(e){const t=u("previewMedia"),n=u("previewMediaImage");t&&n&&(e?(t.classList.add("visible"),n.src=e):(t.classList.remove("visible"),n.removeAttribute("src")))}(e.mediaUrl),function(e){const t=u("previewButton"),n=u("previewButtonText");t&&n&&(e?(t.hidden=!1,n.innerHTML=E(e)):(t.hidden=!0,n.textContent=""))}(e.buttonLabel)}(e),T(S(e)),$(e),r||t.trigger("setActivityDirtyState",!0)}function x(e,t){const n=u(e);n&&("SELECT"===n.tagName?n.value=t||n.options[0]?.value:n.value=t||"","recipientTo"===e&&(v=Boolean(t)))}function C(e){o=e||{};const t=(o?.arguments?.execute?.inArguments||[]).reduce((e,t)=>Object.assign(e,t),{});r=!0,x("campaignName",t.campaignName),x("senderName",t.senderName),x("messageTemplate",t.messageTemplate),x("messageBody",t.messageBody),x("mediaUrl",t.mediaUrl),x("buttonLabel",t.buttonLabel),x("sendType",t.sendType||"immediate"),x("sendSchedule",t.sendSchedule),x("recipientTo",t.recipientTo||t.mobile||t.to),N();const n=S(c),i=!!(Object.keys(t||{}).length>0)&&S(t);T(n||o?.metaData?.isConfigured&&i),$(c),r=!1}function A(e){const t=[["campaignName",e.campaignName],["senderName",e.senderName],["messageTemplate",e.messageTemplate],["messageBody",e.messageBody],["mediaUrl",e.mediaUrl],["buttonLabel",e.buttonLabel],["sendType",e.sendType],["recipientTo",e.recipientTo]];return"schedule"===e.sendType&&e.sendSchedule&&t.push(["sendSchedule",e.sendSchedule]),t.filter(([,e])=>e).map(([e,t])=>({[e]:t}))}function B(e){g=function(e=[]){return(e||[]).map(e=>({key:e?.key,name:e?.name||e?.key?.split(".")?.slice(-1)?.[0],type:e?.type||""})).filter(e=>Boolean(e.key))}(e?.schema),function(){const e=u("recipientOptions");e&&(e.innerHTML="",g.forEach(t=>{const n=document.createElement("option");n.value=O(t.key),n.textContent=t.name?`${t.name} · ${n.value}`:n.value,e.appendChild(n)}))}(),function(){if(v)return;const e=function(){if(!g?.length)return a;const e=g.find(e=>function(e={}){const t=(e.type||"").toLowerCase();if(t.includes("phone")||t.includes("tel"))return!0;const n=`${e.key||""} ${e.name||""}`.toLowerCase();return n.includes("phone")||n.includes("mobile")||n.includes("whatsapp")}(e))||g[0];return e?O(e.key):a}();if(!e)return;const t=u("recipientTo")?.value;t?v=!0:(r=!0,x("recipientTo",e),N(),r=!1)}()}function O(e){return e?e.startsWith("{{")?e:`{{${e}}}`:""}function M(){const e={...c};if(!S(e))return void T(!1);const n={...o,arguments:{...o?.arguments,execute:{...o?.arguments?.execute,inArguments:A(e),outArguments:[]}},configurationArguments:{...o?.configurationArguments},metaData:{...o?.metaData,isConfigured:!0}},r=document.createElement("div");r.className="status-message success",r.innerHTML='\n    <div class="icon">✓</div>\n    <div class="message">Configuration saved successfully!</div>\n  ',document.body.appendChild(r),setTimeout(()=>{r.remove()},3e3),t.trigger("updateActivity",n),t.trigger("setActivityDirtyState",!1),t.trigger("requestInspectorClose")}function I(e){y=e||{}}function _(e){h=e||{}}function j(){const e=w(),t=S(e);$(e),t&&M()}function q(){t.trigger("gotoStep",b)}function D(e){e&&(b="string"==typeof e?e:e.key||b,$(c))}function $(e=c){const n=S(e);t.trigger("updateButton",{button:"next",enabled:n}),t.trigger("updateButton",{button:"done",enabled:n})}document.addEventListener("DOMContentLoaded",function(){d.forEach(e=>{const t=u(e);if(!t)return;const n="SELECT"===t.tagName||"datetime-local"===t.type?"change":"input";t.addEventListener(n,N)}),u("cancel")?.addEventListener("click",()=>{t.trigger("setActivityDirtyState",!1),t.trigger("requestInspectorClose")}),u("done")?.addEventListener("click",M),t.on("initActivity",C),t.on("requestedSchema",B),t.on("requestedTokens",I),t.on("requestedEndpoints",_),t.on("clickedNext",j),t.on("clickedBack",q),t.on("gotoStep",D),t.trigger("ready"),t.trigger("requestSchema"),t.trigger("requestTokens"),t.trigger("requestEndpoints"),t.trigger("requestInteraction")})})()})();